<!DOCTYPE html>
<html lang="es">

<!--Estilo de las casillas-->
<style>
    input:required:invalid {
        border: 2px solid red;
    }

    input:required:valid {
        border: 2px solid green;
    }
</style>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitud de Baja de Vehículos</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h3>Solicitud de baja de vehículos.</h3>
        <form>
            <h5>Datos del vehiculo</h5>
            <!-- Datos del vehículo -->
            <div class="form-row">
                <div class="col-md-4 mb-3">
                    <label for="matricula">Matrícula</label>
                    <input type="text" class="form-control" id="matricula" pattern="^[0-9]{4}[BCDFGHJKLMNPQRSTVWXYZ]{3}$" placeholder="0000AAA" required>
                </div>                
                <div class="col-md-4 mb-3">
                    <label for="fechaMatriculacion">Fecha matriculación</label>
                    <input type="date" class="form-control" id="fechaMatriculacion" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="ultNumBastidor">6 últimos dígitos (Nº bastidor)</label>
                    <input type="text" class="form-control" id="ultNumBastidor" pattern="^[0-9]{6}$" placeholder="000000" required>
                </div>
            </div>
            
            <h5>Datos del titular</h5>
            <!-- Datos del titular -->
            <div class="form-row">
                <div class="col-md-4 mb-3">
                    <label for="nombre">Nombre</label>
                    <input type="text" class="form-control" id="nombre" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="apellidos">Apellidos</label>
                    <input type="text" class="form-control" id="apellidos" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="domicilio">Domicilio</label>
                    <input type="text" class="form-control" id="domicilio" required>
                </div>
            </div>

            <div class="form-row">
                <div class="col-md-3 mb-3">
                    <label for="dni">DNI</label>
                    <input type="text" class="form-control" id="dni" pattern="^[0-9]{8}[A-Z]$" placeholder="00000000A" required>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="email">Correo electrónico</label>
                    <input type="email" class="form-control" id="email" pattern="^[a-zA-Z]+@[a-zA-Z]+\.(com|es)$" placeholder="email@gmail.com" required>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="telefono">Teléfono</label>
                    <input type="tel" class="form-control" id="telefono" pattern="^[0-9]{9}$" placeholder="000000000" required>
                </div>
                <div class="col-md-3 mb-3">
                    <label>Tipo de baja:</label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipoBaja" id="temporal" value="Temporal" required>
                    <label class="form-check-label" for="temporal">Temporal</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipoBaja" id="definitiva" value="Definitiva" required>
                    <label class="form-check-label" for="definitiva">Definitiva</label>
                </div>
                </div>
            </div>

            <button class="btn btn-primary" type="submit">Enviar</button>
        </form>
    </div>

    <script>
        // Definición de la clase Vehiculo
        class Vehiculo {
            constructor(matricula, fechaMatriculacion, ultNumBastidor) {
                this.matricula = matricula;
                this.fechaMatriculacion = fechaMatriculacion;
                this.ultNumBastidor = ultNumBastidor;
            }

            // Método para validar la matrícula
            validateMatricula() {
                if (this.matricula.validity.patternMismatch) {
                    this.matricula.setCustomValidity("La matrícula debe teener el formato 0000AAA con 4 numeros y 3 letras sin vocales");
                } else {
                    this.matricula.setCustomValidity(""); // Restablece el mensaje si el valor es valido
                }
            }
        }

        // Instancia de la clase Vehiculo con los campos correspondientes
        let matriculaInput = document.getElementById('matricula');
        let fechaMatriculacionInput = document.getElementById('fechaMatriculacion');
        let ultNumBastidorInput = document.getElementById('ultNumBastidor');

        let vehiculo = new Vehiculo(matriculaInput, fechaMatriculacionInput, ultNumBastidorInput);

        // Asociar el método de validación de la matrícula a los eventos correspondientes
        matriculaInput.addEventListener('input', () => vehiculo.validateMatricula());

        class Propietario {
            constructor(nombre, apellidos, domicilio, dni, correo, telefono) {
                this.nombre = nombre;
                this.apellidos = apellidos;
                this.domicilio = domicilio;
                this.dni = dni;
                this.correo = correo;
                this.telefono = telefono;
            }

            // Método para validar el DNI
            validateDNI() {
                if (this.dni.validity.patternMismatch) {
                    this.dni.setCustomValidity("El DNI debe tener 8 números seguidos de una letra.");
                } else {
                    this.dni.setCustomValidity(""); // Restablece el mensaje si el valor es válido
                }
            }

            // Método para validar el correo electrónico
            validateCorreo() {
                if (this.correo.validity.patternMismatch) {
                    this.correo.setCustomValidity("El correo debe ser de un formato válido (ejemplo@dominio.com).");
                } else {
                    this.correo.setCustomValidity(""); // Restablece el mensaje si el valor es válido
                }
            }

            // Método para validar el teléfono
            validateTelefono() {
                if (this.telefono.validity.patternMismatch) {
                    this.telefono.setCustomValidity("El teléfono debe tener 9 dígitos.");
                } else {
                    this.telefono.setCustomValidity(""); // Restablece el mensaje si el valor es válido
                }
            }

            // metodo para cambiar el texto de la etiqueta DNI cuando se recibe el foco
            cambiarTextoDni() {
                const dniInput = document.getElementById('dni');
                const dniLabel = document.getElementById('dniLabel');
                
                // cambiar el texto cuando el campo recibe el foco
                dniInput.addEventListener('focus', function () {
                    dniLabel.textContent = 'Editando DNI...';
                });

                // volver al texto original cuando el campo pierde el foco
                dniInput.addEventListener('blur', function () {
                    dniLabel.textContent = 'DNI';
                });
            }
        }

        // Instancia de la clase Propietario con los campos correspondientes
        let nombreInput = document.getElementById('nombre');
        let apellidosInput = document.getElementById('apellidos');
        let domicilioInput = document.getElementById('domicilio');
        let dniInput = document.getElementById('dni');
        let correoInput = document.getElementById('email');
        let telefonoInput = document.getElementById('telefono');

        let propietario = new Propietario(nombreInput, apellidosInput, domicilioInput, dniInput, correoInput, telefonoInput);

        // Asociar los métodos de validación de los campos de Propietario
        dniInput.addEventListener('input', () => propietario.validateDNI());
        correoInput.addEventListener('input', () => propietario.validateCorreo());
        telefonoInput.addEventListener('input', () => propietario.validateTelefono());
        propietario.cambiarTextoDni();
    </script>

</body>
</html>
